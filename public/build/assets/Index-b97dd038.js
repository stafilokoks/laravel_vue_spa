import{o as l,c as u,d as s,j as w,t as v,F as $,k as S,l as C,a as E,g as y,v as g,w as N,r as m,u as k,e as d,i as _}from"./app-457d9ccf.js";import{_ as L}from"./ErrorsLabel-ba55a3ea.js";const U={class:"pb-3"},A={class:"flex justify-between"},I=s("h1",{class:"text-2xl"}," Countries ",-1),R={class:"capitalize"},T={name:"TopSection",props:["userName"],setup(n){return(a,r)=>(l(),u("div",U,[s("div",A,[I,s("span",R,[w("Welcome "+v(n.userName)+", ",1),s("button",{class:"text-orange-500 underline hover:no-underline rounded-md",onClick:r[0]||(r[0]=e=>a.$emit("handle-logout"))},"Logout")])])]))}},B={class:"flex flex-row py-3 border-b text-gray-600"},M={class:"basis-1/2 pl-3"},O={class:"basis-1/2"},V={class:"pr-3"},D={name:"Country",props:["country"],setup(n){return(a,r)=>(l(),u("div",B,[s("div",M,v(n.country.name),1),s("div",O,v(n.country.capital),1),s("div",V,[s("button",{class:"float-right bg-red-400 px-2 text-white font-bold rounded-md hover:bg-red-600",onClick:r[0]||(r[0]=e=>a.$parent.$emit("delete-country",n.country.id))},"Ã— ")])]))}},K={class:"border-t mt-3"},j=s("div",{class:"flex flex-row py-3 border-b text-slate-100 bg-gray-400 font-bold"},[s("div",{class:"basis-1/2 pl-3"},"Country name"),s("div",{class:"basis-1/2"},"Country capital"),s("div",{class:"text-right pr-3"},"Delete")],-1),q={name:"CountryList",props:["countries"],emits:["delete-country"],setup(n){return(a,r)=>(l(),u("div",K,[j,(l(!0),u($,null,S(n.countries,e=>(l(),C(D,{country:e},null,8,["country"]))),256))]))}},H=s("button",{class:"bg-blue-600 text-white px-5 py-2 rounded-md ml-2 hover:bg-blue-400",type:"submit"}," Add ",-1),z={name:"NewCountry",setup(n){const a=E({name:"",capital:""});return(r,e)=>(l(),u("form",{class:"pb-3 flex gap-2",method:"post",onSubmit:e[2]||(e[2]=N(i=>r.$emit("add-country",a),["prevent"]))},[y(s("input",{type:"text",class:"p-2 w-64 border rounded-md","onUpdate:modelValue":e[0]||(e[0]=i=>a.name=i),placeholder:"Country name",required:""},null,512),[[g,a.name]]),y(s("input",{type:"text",class:"p-2 w-64 border rounded-md","onUpdate:modelValue":e[1]||(e[1]=i=>a.capital=i),placeholder:"Country capital",required:""},null,512),[[g,a.capital]]),H],32))}},F={class:"w-6/12 p-10 mx-auto"},P={name:"Index",setup(n){const a=m([]),r=k(),e=m(),i=m("");let c="";const b=()=>{i.value=localStorage.getItem("USER_NAME");const o=localStorage.getItem("USER_TOKEN");(o!==void 0||o!=="")&&(c={headers:{Authorization:"Bearer "+o}})},p=async()=>{try{const o=await _.get("/api/countries",c);a.value=o.data.data}catch(o){o&&o.response&&o.response.status===401&&(localStorage.removeItem("USER_NAME"),localStorage.removeItem("USER_TOKEN"),await r.push({name:"Login"}))}},f=()=>{localStorage.removeItem("USER_TOKEN"),r.push({name:"Login"})},h=async o=>{if(window.confirm("Are you sure"))try{(await _.delete(`/api/countries/${o}`,c)).status===204&&await p()}catch{await r.push({name:"Login"})}},x=async o=>{e.value="";try{(await _.post("/api/countries",o,c)).status===201&&await p()}catch(t){if(t&&t.response&&t.response.status)switch(t.response.status){case 401:localStorage.removeItem("USER_NAME"),localStorage.removeItem("USER_TOKEN"),await r.push({name:"Login"});break;case 422:t&&t.response.data&&t.response.data.errors?e.value=Object.values(t.response.data.errors):e.value=t.response.data.message;break}}};return b(),p(),(o,t)=>(l(),u("div",F,[d(T,{"user-name":i.value,onHandleLogout:t[0]||(t[0]=W=>f())},null,8,["user-name"]),d(L,{errors:e.value},null,8,["errors"]),d(z,{onAddCountry:x}),d(q,{countries:a.value,onDeleteCountry:h},null,8,["countries"])]))}};export{P as default};
